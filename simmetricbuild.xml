<?xml version="1.0" encoding="UTF-8"?>
<project name="simmetrics" default="dist" basedir=".">
  <description>This buildfile was generated by GenerateAnt plugin for IntelliJ IDEA</description>
  <!--set global properties for this build-->
  <property name="src" location="src" />
  <property name="build" location="classes" />
  <property name="dist" location="dist" />
  <property name="distlib" location="dist/lib" />
  <property name="docs" location="docs" />
  <property name="docsapi" location="docs/api" />
  <property name="tests" location="test" />
  <property name="reports" location="test/report" />
  <property name="htmlreports" location="test/report/html" />
  <target name="clean">
    <!--Delete created directory trees-->
    <delete dir="${build}" includeEmptyDirs="true" />
    <delete includeEmptyDirs="true">
      <fileset dir="${dist}" excludes="lib/**" />
    </delete>
    <delete dir="${docs}" includeEmptyDirs="true" />
    <delete dir="${docsapi}" includeEmptyDirs="true" />
    <delete dir="${tests}" includeEmptyDirs="true" />
    <delete dir="${reports}" includeEmptyDirs="true" />
    <delete dir="${htmlreports}" includeEmptyDirs="true" />
  </target>
  <target name="init">
    <!--creates the build directory-->
    <mkdir dir="${build}" />
    <mkdir dir="${dist}" />
    <mkdir dir="${distlib}" />
    <mkdir dir="${docs}" />
    <mkdir dir="${docsapi}" />
    <mkdir dir="${tests}" />
    <mkdir dir="${reports}" />
    <mkdir dir="${htmlreports}" />
  </target>
  <target name="resources">
    <copy todir="${build}">
      <fileset dir="${src}">
        <include name="**/*.jpe" />
        <include name="**/*.jpeg" />
        <include name="**/*.rmf" />
        <include name="**/*.wav" />
        <include name="**/*.mid" />
        <include name="**/*.midi" />
        <include name="**/*.au" />
        <include name="**/*.gif" />
        <include name="**/*.png" />
        <include name="**/*.aiff" />
        <include name="**/*.properties" />
      </fileset>
    </copy>
  </target>
  <target name="build" depends="init, resources">
    <!--Compiles the java code from ${src} directory into ${build} directory-->
    <javac destdir="${build}">
      <src path="${src}" />
      <exclude name="**/*Test.java" />
      <exclude name="**/Test*.java" />
    </javac>
  </target>
  <target name="dist" depends="build">
    <!--Put everything in ${build} into the MyProject-${DSTAMP}.jar file-->
    <tstamp />
    <jar jarfile="${dist}/simmetrics-${DSTAMP}.jar" basedir="${build}" />
  </target>
  <target name="doc" depends="init">
    <javadoc destdir="${docsapi}" author="true" version="true" use="true" windowtitle="API for simmetrics">
      <fileset dir="${src}" defaultexcludes="yes">
        <exclude name="**/*Test.java" />
        <exclude name="**/Test*.java" />
      </fileset>
    </javadoc>
  </target>
  <target name="build_tests" depends="init">
    <!--Compiles the tests into ${tests} directory-->
    <javac destdir="${tests}">
      <src path="${src}" />
      <include name="**/*Test.java" />
      <include name="**/Test*.java" />
      <src path="${src}" />
    </javac>
  </target>
  <target name="run_tests" depends="build, build_tests">
    <junit printsummary="yes">
      <classpath path="${build}" />
      <classpath path="${tests}" />
      <formatter type="xml" usefile="true" />
      <batchtest todir="${reports}">
        <fileset dir="${tests}">
          <include name="**/*Test.class" />
          <include name="**/Test*.class" />
        </fileset>
      </batchtest>
    </junit>
  </target>
  <target name="report" depends="run_tests">
    <junitreport todir="${reports}">
      <fileset dir="${reports}">
        <include name="TEST-*.xml" />
      </fileset>
      <report format="noframes" todir="${htmlreports}" />
    </junitreport>
  </target>
</project>

